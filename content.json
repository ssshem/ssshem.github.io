{"meta":{"title":"Welcome To My World | ssshem","subtitle":"","description":"","author":null,"url":"http://yoursite.com"},"pages":[],"posts":[{"title":"在服务器搭建git服务器","slug":"build-gitserver-on-linux","date":"2019-11-10T13:10:56.000Z","updated":"2019-11-10T16:44:00.695Z","comments":false,"path":"2019/11/10/build-gitserver-on-linux/","link":"","permalink":"http://yoursite.com/2019/11/10/build-gitserver-on-linux/","excerpt":"","text":"服务端操作安装Git及创建用户组、用户123yum install gitgroupadd gitadduser git -g git 禁止用户git登录修改/etc/passwd文件： 找到这句： git:x:503:503::/home/git:/bin/bash 改为： git:x:503:503::/home/git:/usr/bin/git-shellgit-shell这个命令地址有可能不是/usr/bin/git-shell，最好用which git-shell命令查看一下，确保命令地址正确。 创建证书登录12345mkdir /home/git/.sshchmod 700 /home/git/.sshchown -R git:git /home/git/.ssh/touch /home/git/.ssh/authorized_keyschmod 600 /home/git/.ssh/authorized_keys 启用免密登录/etc/ssh/sshd_config，启用该文件中以下三项内容： RSAAuthentication yes PubkeyAuthentication yes AuthorizedKeysFile .ssh/authorized_keys 然后重启ssh服务：service sshd restart 创建git仓库12345678$ cd /srv$ mkdir gitrepo$ chown git:git gitrepo/$ cd gitrepo# 创建一个空的Git仓库，服务器上的Git仓库通常都以.git结尾 $ git init --bare project-name.git# 将仓库所属用户改为git $ chown -R git:git project.git 客户端操作生成密钥ssh-keygen -t rsa -C “youremail@xxx.com“ 如果不想以后使用时再输入密码，就一路回车，会生成id_rsa密钥文件和id_rsa.pub公钥文件，存放的地址会默认放在c:/Users/Shem/.ssh目录下。 如果有用户密码：可以使用命令将密钥追加到服务器git用户目录/home/git/.ssh/authorized_keys文件中：ssh root@host ‘mkdir -p /home/git/.ssh &amp;&amp; cat &gt;&gt; /home/git/.ssh/authorized_keys’ &lt; ~/.ssh/id_rsa.pub 也可以使用root登录后，将公钥内容直接复制，vim打开/home/git/.ssh/authorized_keys文件粘贴到里面去，一行一个公钥 拉取项目git clone git@xxx.xxx.xxx.xxx:/srv/gitrepo/project-name.git（默认ssh端口为22） git clone ssh://git@xxx.xxx.xxx.xxx:22/srv/gitrepo/project-name.git 如果ssh端口不是22，则需要修改此命令 免密访问失效的原因 可能是以上操作中的文件或者目录权限不正确，需要检查一遍 可能是selinux的开启导致 可能是以上操作“禁止用户git登录”导致的，则需要取消这个操作 参考 Git简单生成公钥和私钥的方法 搭建属于你自己的 Git 服务器 Git服务器搭建之CentOs7-阿里云搭建 Linux下实现免密登录 selinux 开启和关闭 Centos服务器ssh免密登录以及搭建私有git服务器 SSH原理与运用（一）：远程登录 搭建git服务器ssh免密码登录问题","categories":[{"name":"运维","slug":"运维","permalink":"http://yoursite.com/categories/%E8%BF%90%E7%BB%B4/"}],"tags":[{"name":"Git","slug":"Git","permalink":"http://yoursite.com/tags/Git/"},{"name":"实践","slug":"实践","permalink":"http://yoursite.com/tags/%E5%AE%9E%E8%B7%B5/"}],"keywords":[{"name":"运维","slug":"运维","permalink":"http://yoursite.com/categories/%E8%BF%90%E7%BB%B4/"}]}]}